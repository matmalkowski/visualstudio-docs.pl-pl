---
title: Napraw niewykrywalnych parametrów dynamicznych w teście wydajności sieci web w programie Visual Studio
ms.date: 10/19/2016
ms.topic: conceptual
helpviewer_keywords:
- walkthroughs, load tests
- load tests, walkthroughs
- load tests, correlating dynamic parameters
ms.assetid: 92dff25c-36ee-4135-acdd-315c4962fa11
author: gewarren
ms.author: gewarren
manager: douge
ms.prod: visual-studio-dev15
ms.technology: vs-ide-test
ms.openlocfilehash: 379291059157980a86d0379c69c0d592eee83a99
ms.sourcegitcommit: 5b767247b3d819a99deb0dbce729a0562b9654ba
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 07/20/2018
ms.locfileid: "39177828"
---
# <a name="fix-non-detectable-dynamic-parameters-in-a-web-performance-test"></a>Naprawa niewykrywalnych parametrów dynamicznych w teście wydajności sieci Web

Niektóre witryny sieci Web używają parametrów dynamicznych do przetwarzania niektórych swoich żądań sieci web. Parametr dynamiczny to parametr, którego wartość jest generowana za każdym razem, gdy użytkownik uruchamia aplikację. Przykładem parametru dynamicznego jest identyfikator sesji. Identyfikator sesji zazwyczaj zmienia się co 5 – 30 minut. Web wydajności testów Rejestrator i aparat odtwarzania automatycznie obsługuje najbardziej powszechne typy parametrów dynamicznych:

-   Wartości parametrów dynamicznych ustawione w wartościach plików cookie. Aparat testu wydajności sieci web automatycznie obsługuje je podczas odtwarzania.

-   Wartości parametrów dynamicznych, które są ustawione w ukrytych polach na stronach HTML, takich jak ASP.NET, wyświetlić stan. Są one automatycznie obsługiwane przez rejestrator, który dodaje reguły wyodrębniania pól ukrytych do testu.

-   Wartości parametrów dynamicznych ustawione jako ciąg zapytania lub formularza Parametry księgowania. Są one obsługiwane za pomocą wykrywania parametrów dynamicznych po zarejestrowaniu testu wydajności sieci web.

Niektóre typy parametrów dynamicznych nie są wykrywane. Parametr dynamiczny niewykryte spowoduje, że test wydajności sieci web niepowodzenie podczas uruchamiania, ponieważ wartość dynamiczna będzie prawdopodobnie inny ilekroć dany test jest uruchomiony. Aby prawidłowo obsługiwać te parametry, można dodać reguły wyodrębniania do parametrów dynamicznych w testach wydajności sieci web ręcznie.

## <a name="create-and-run-a-web-app-with-dynamic-parameters"></a>Tworzenie i uruchamianie aplikacji sieci web z parametrami dynamicznymi

Aby wykazać wykrywalny i niewykrywalny parametr dynamiczny, utworzymy prostą aplikację sieci web platformy ASP.NET, która ma trzy formularze sieci web z kilkoma formantami i kodem niestandardowym. Firma Microsoft następnie dowiesz się, jak izolować parametry dynamiczne i jak je obsłużyć.

1.  Utwórz nowy projekt ASP.NET o nazwie **DynamicParameterSample**.

     ![Utwórz pusty projekt aplikacji sieci web ASP.NET](../test/media/web_test_dynamicparameter_aspproject.png)

2.  Dodaj formularz sieci web o nazwie *Querystring.aspx*.

3.  W widoku projektu przeciągnij formant HiddenField na stronę, a w następnie zmień wartość właściwości (ID) na HiddenFieldSessionID.

     ![Dodaj formant HiddenField](../test/media/web_test_dynamicparameter_hiddenfield.png)

4.  Zmień na widok źródła dla strony Querystring i Dodaj następujący wyróżniony kod ASP.NET i JavaScript używany do generowania parametrów dynamicznych Identyfikatora sesji makiety:

    ```html
    <head runat="server">
    <title>JavaScript dynamic property correlation sample</title><script type="text/javascript" language="javascript">    <!--        function jScriptQueryString()         {            var Hidden = document.getElementById("HiddenFieldSessionID");            var sessionId = Hidden.value;            window.location = 'JScriptQuery.aspx?CustomQueryString=jScriptQueryString___' + sessionId;         }    //--></script>
    </head>
    <body>
        <form id="form1" runat="server">
        <div>
             <a name="QuerystringHyperlink" href="ASPQuery.aspx?CustomQueryString=ASPQueryString___<%= Session.SessionID %>">Dynamic querystring generated by ASP.net</a>         <br/>         <br/>         <a href="javascript:jScriptQueryString()">Dynamic querystring generated by javascript </a>
        </div>
        <asp:HiddenField ID="HiddenFieldSessionID" runat="server" />
        </form>
    </body>
    </html>
    ```

5.  Otwórz *Querystring.aspx.cs* pliku i Dodaj następujący wyróżniony kod do metody Page_Load:

    ```csharp
    public partial class Querystring : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {
            Session.Add("Key", "Value");HiddenFieldSessionID.Value = Session.SessionID;
        }
    }
    ```

6.  Dodaj drugi formularz sieci web o nazwie *ASPQuery.aspx*.

7.  W widoku projektu przeciągnij **etykiety** na stronę i zmień wartość jego **(ID)** właściwości **IndexLabel**.

     ![Dodaj etykietę do formularza sieci web](../test/media/web_test_dynamicparameter_label.png)

8.  Przeciągnij **hiperłącze** na stronę i zmień back jego **tekstu** właściwości **ponownie**.

     ![Dodawanie hiperlinku do formularza sieci web](../test/media/web_test_dynamicparameter_hyperlink.png)

9. Wybierz **(...)**  dla **NavigationURL** właściwości.

     ![Edytuj właściwość NavigateURL](../test/media/web_test_dynamicparameter_hyperlink_navurl.png)

     Wybierz *Querystring.aspx*.

     ![Wybierz adres URL jako Querystring.aspx](../test/media/web_test_dynamicparameter_hyperlink_navurl2.png)

10. Otwórz *ASPQuery.aspx.cs* pliku i Dodaj następujący wyróżniony kod do metody Page_Load:

    ```csharp
    protected void Page_Load(object sender, EventArgs e)
            {
                int index;            string qstring;            string dateportion;            string sessionidportion;            qstring = Request.QueryString["CustomQueryString"];            index = qstring.IndexOf("___");            dateportion = qstring.Substring(0, index);            index += 3;            sessionidportion = qstring.Substring(index, qstring.Length - index);            if (sessionidportion != Session.SessionID)            {                Response.StatusCode = 401;                IndexLabel.Text = "Failure!  Invalid querystring parameter found.";            }            else            {                IndexLabel.Text = "Success.  Dynamic querystring parameter was found.";            }            IndexLabel.Text += "<br>\r\n";
            }
    ```

11. Dodaj trzeci formularz sieci web o nazwie *JScriptQuery.aspx*.

     Podobnie jak zrobiliśmy na drugiej stronie, przeciągnij **etykiety** na formularz, ustawiając jego **(ID)** właściwości **IndexLabel** i przeciągnij **hiperłącze** na formularz, ustawiając jego **tekstu** właściwości **ponownie**i jego **NavigationURL** właściwości **Querystring.aspx**.

     ![Dodawanie i konfigurowanie trzeci formularz sieci web](../test/media/web_test_dynamicparameter_addwebform3.png)

12. Otwórz *JScriptQuery.aspx.cs* pliku i Dodaj następujący wyróżniony kod do metody Page_Load:

    ```csharp
    protected void Page_Load(object sender, EventArgs e)
            {
                int index;            string qstring;            string dateportion;            string sessionidportion;            qstring = Request.QueryString["CustomQueryString"];            index = qstring.IndexOf("___");            dateportion = qstring.Substring(0, index);            index += 3;            sessionidportion = qstring.Substring(index, qstring.Length - index);            if (sessionidportion != Session.SessionID)            {                Response.StatusCode = 401;                IndexLabel.Text = "Failure!  Invalid querystring parameter found.";            }            else            {                IndexLabel.Text = "Success.  Dynamic querystring parameter was found.";            }            IndexLabel.Text += "<br>\r\n";
            }
    ```

13. Zapisz projekt.

14. W **Eksploratora rozwiązań**ustaw *Querystring.aspx* jako stronę startową.

     ![Ustawianie strony początkowej na Querystring.aspx](../test/media/web_test_dynamicparameter_setstartpage.png)

15. Naciśnij klawisz **Ctrl**+**F5** do uruchamiania aplikacji sieci web w przeglądarce. Skopiuj adres URL. Będą potrzebne podczas rejestrowania testu.

16. Wypróbuj oba łącza. Wszystkie powinny wyświetlać komunikat "Success." Dynamiczny parametr ciągu kwerendy znaleziono."

     ![Uruchamianie aplikacji sieci web](../test/media/web_test_dynamicparameter_runapp.png)

     ![Powodzenie&#33;](../test/media/web_test_dynamicparameter_runapp2.png)

## <a name="create-a-web-performance-test"></a>Utwórz test wydajności sieci web

1.  Dodaj projekt testu obciążenia i wydajności sieci web do rozwiązania.

     ![Dodaj projekt testu wydajności i obciążenia sieci web](../test/media/web_test_dynamicparameter_addtestproject.png)

2.  Zmień nazwę WebTest1.webtest na DynamicParameterSampleApp.webtest.

     ![Zmień nazwę testu wydajności sieci web](../test/media/web_test_dynamicparameter_renametest.png)

3.  Rejestruj badanie.

     ![Rejestrowanie testu wydajności sieci web](../test/media/web_test_dynamicparameter_recordtest.png)

4.  Skopiuj i wklej adres URL z testowanej witryny sieci Web do przeglądarki.

     ![Wklej adres URL z witryny sieci Web poddawana testom](../test/media/web_test_dynamicparameter_recordtest2.png)

5.  Przeglądaj aplikację sieci web. Wybierz łącze programu ASP.NET, łącze Wstecz, a następnie łącze javascript, a następnie łącze Wstecz.

     Rejestrator testu sieci web wyświetla adresów URL żądań i odpowiedzi HTTP podczas nawigowania przez aplikację sieci web.

6.  Wybierz **zatrzymać** przycisku na rejestratorze testu.

     Okno dialogowe dla wykrywania parametrów dynamicznych Wyświetla pasek postępu pokazujący stan wykrywania parametrów w odpowiedziach HTTP, które zostały odebrane.

7.  Dynamiczny parametr obiektu CustomQueryString na stronie ASPQuery jest wykrywany automatycznie. Jednakże dynamiczny parametr obiektu CustomQueryString na stronie JScriptQuery nie zostanie wykryty.

     Wybierz **OK** można dodać regułę ekstrakcji *Querystring.aspx*, wiążące go do strony ASPQuery.

     ![Podwyższanie poziomu wykrytym parametrem dynamicznym](../test/media/web_test_dynamicparameter_promotedialog.png)

     Reguła ekstrakcji jest dodawana do pierwszego żądania *Querystring.aspx*.

     ![Reguła wyodrębniania dodawana do żądania](../test/media/web_test_dynamicparameter_autoextractionrule.png)

     Rozwiń drugie żądanie w drzewie żądań dla *ASPQuery.aspx* i zwróć uwagę, że wartość customquerystring powiązano z regułą wyodrębniania.

     ![CustomQueryString powiązany z reguły wyodrębniania](../test/media/web_test_dynamicparameter_autoextractionrule2.png)

8.  Zapisz test.

## <a name="run-the-test-to-isolate-the-non-detected-dynamic-parameter"></a>Uruchom test, aby odizolować niewykryty parametr dynamiczny

1.  Uruchom test.

     ![Uruchamianie testu wydajności sieci web](../test/media/web_test_dynamicparameter_runtest.png)

2.  Czwarty żądanie dla *JScriptQuery.aspx* stronie kończy się niepowodzeniem. Przejdź do testu sieci web.

     ![Błąd parametrów dynamicznych w wynikach testu](../test/media/web_test_dynamicparameter_runresults.png)

     *JScriptQuery.aspx* węźle żądania jest wyróżniony w edytorze. Rozwiń węzeł i zwróć uwagę, że część "1v0yhyiyr0raa2w4j4pwf5zl" elementu CustomQueryString wydaje się być dynamiczna.

     ![Podejrzane dynamiczny parametr dla CustomQueryString](../test/media/web_test_dynamicparameter_runresults2.png)

3.  Wróć do podglądu wyników testu wydajności sieci Web i wybierz *JScriptQuery.aspx* strona kodowa nie powiodło się. Następnie wybierz kartę żądanie, sprawdź, czy jest wyczyszczone pole wyboru Pokaż dane surowe, przewiń w dół i wybierz Szybkie szukanie na CustomQueryString.

     ![Zastosowanie szybkiego wyszukiwania do izolowania parametrów dynamicznych](../test/media/web_test_dynamicparameter_runresultsquckfind.png)

4.  Zdajemy sobie sprawę patrząc Edytor testów, który *JScriptQuery.aspx* CustomQueryString żądania została przypisana wartość: `jScriptQueryString___1v0yhyiyr0raa2w4j4pwf5zl`, i że podejrzana część dynamiczna to "1v0yhyiyr0raa2w4j4pwf5zl". W polu Znajdź rozwijanej listy, Usuń podejrzaną część ciągu wyszukiwania. Ciąg powinien być "CustomQueryString = jScriptQueryString___".

     Parametry dynamiczne są przypisywane ich wartości w jednym z żądań, które poprzedza żądanie, w którym występuje błąd. W związku z tym, zaznacz pole wyboru wyszukiwania i wybieraj Znajdź następny dopóki nie zobaczysz poprzedzającego żądanie *Querystring.aspx* wyróżnionego w panelu żądania. To powinno nastąpić, po dokonaniu wyboru Znajdź następny trzy razy.

     ![Zastosowanie szybkiego wyszukiwania do izolowania parametrów dynamicznych](../test/media/web_test_dynamicparameter_runresultsquckfind4.png)

     Jak pokazano na karcie odpowiedzi, a w języku JavaScript, zaimplementowane wcześniej pokazano poniżej, parametr ciągu zapytania CustomQueryString ma przypisaną wartość "jScriptQueryString___" i jest łączony z wartością zwróconą przez zmienna sessionId.

    ```javascript
    function jScriptQueryString()          {             var Hidden = document.getElementById("HiddenFieldSessionID");             var sessionId = Hidden.value;             window.location = 'JScriptQuery.aspx?CustomQueryString=jScriptQueryString___' + sessionId;          }

    ```

     Teraz, gdy wiemy, gdzie występuje błąd oraz że musimy wyodrębnić wartość dla identyfikatora sesji. Jednakże wartością wyodrębniania jest tylko tekst, więc trzeba dodatkowo wyizolować błąd przez próbę zlokalizowania ciągu, na którym jest wyświetlana rzeczywista wartość identyfikatora sesji. Patrząc na kod, możesz zobaczyć, że zmienna sessionId jest równa wartości zwracanej przez HiddenFieldSessionID.

5.  Użyj funkcji szybkiego znajdowania na HiddenFieldSessionID, czyszcząc pole wyboru wyszukiwania i wybierając bieżące żądanie.

     ![Zastosowanie szybkiego wyszukiwania na HiddenFieldSession](../test/media/web_test_dynamicparameter_runresultsquckfindhiddensession.png)

     Należy zauważyć, że wartość zwracana jest nagrywania nie tym samym ciągiem jak oryginalne testu wydajności sieci web. Dla tego przebiegu testu wartość zwracana jest "5w4v3yrse4wa4axrafykqksq", a w oryginalnym nagraniu wartość to "1v0yhyiyr0raa2w4j4pwf5zl". Ponieważ wartość jest niezgodna z oryginalnym nagraniu, zostanie wygenerowany błąd.

6.  Ponieważ trzeba naprawić parametr dynamiczny w oryginalnym nagraniu, wybierz zarejestrowany wynik na pasku narzędzi.

     ![Wybierz zarejestrowany wynik](../test/media/web_test_dynamicparameter_recordedresult.png)

7.  W zarejestrowanych wynikach wybierz trzecie żądanie, która jest taka sama *Querystringrequest.aspx* żądaniem w wynikach testu.

     ![Wybierz tego samego żądania w zarejestrowanych wynikach](../test/media/web_test_dynamicparameter_recordedresultsselectnode.png)

     Wybierz kartę odpowiedzi, przewiń w dół i wybierz wartość oryginalnego parametru dynamicznego "1v0yhyiyr0raa2w4j4pwf5zl" wyodrębnionego wcześniej oraz dodawanie reguły wyodrębniania.

     ![Dodawanie reguły wyodrębniania do parametrów dynamicznych](../test/media/web_test_dynamicparameter_recordedresultaddextractionrule.png)

     Nowa reguła ekstrakcji jest dodawany do *Querystring.aspx* żądania i ma przypisaną wartość 'Param0'.

     Jeśli okno dialogowe informuje o nas znaleziono dopasowań dla wyodrębnionego tekstu, który ma zostać powiązany parametr do wyboru **tak**.

     ![Reguła wyodrębniania utworzona](../test/media/web_test_dynamicparameter_addextractiondialog.png)

8.  Wybierz **Znajdź następny**. Pierwsze dopasowanie jest ten, który trzeba zmienić, czyli parametrem dla CustomQueryString dla strony JScriptQuery.

     ![Znajdowanie i zastępowanie tekstu dla parametru](../test/media/web_test_dynamicparameter_addextractionfindreplace.png)

9. Wybierz **Zastąp**.

     ![Zastąp tekst za pomocą parametru](../test/media/web_test_dynamicparameter_addextractionfindreplace2.png)

     Parametr QueryString *JScriptQuery.aspx* żądania jest aktualizowany za pomocą nowego parametru kontekstu: CustomQueryString = jScriptQueryString___ {{Param0}}.

     ![Parametr dotyczą querystring](../test/media/web_test_dynamicparameter_addextractionfindreplace3.png)

10. Zamknij **Znajdź i Zamień** okna dialogowego. Zwróć uwagę na podobną strukturę w drzewie żądań między wykrytym parametrem dynamicznym a niewykrytym parametrem dynamicznym, który skorelowano.

     ![Wykryte i skorelowanych parametrów dynamicznych](../test/media/web_test_dynamicparameter_conclusion.png)

11. Uruchom test. Obecnie działa bez błędów.

## <a name="qa"></a>PYTANIA I ODPOWIEDZI

### <a name="q-can-i-re-run-dynamic-parameter-detection-if-my-web-app-gets-modified"></a>P: czy można ponownie uruchomić wykrywanie parametrów dynamicznych, jeśli Moja aplikacja sieci web zostanie zmodyfikowana?

 **Odp.:** tak, użyj następującej procedury:

1.  Na pasku narzędzi wybierz **Przekształć dynamiczne parametry na parametry testu sieci Web** przycisku.

     Po zakończeniu procesu wykrywania, jeśli wszystkie parametry dynamiczne są wykrywane, **parametry testu Przekształć dynamiczne parametry na sieci web** pojawi się okno dialogowe.

     Parametry dynamiczne są wymienione w kolumnie parametry dynamiczne. Żądania parametru dynamicznego wyodrębnione ze i powiązane są wymienione w Wyodrębnij parametr z odpowiedzi i powiąż kolumny żądania.

     Jeśli wybierzesz parametr dynamiczny w **parametry testu Przekształć dynamiczne parametry na sieci web** okno dialogowe, dwa żądania zostaną wyróżnione w drzewie żądań edytora testów wydajności sieci Web. Pierwsze żądanie będzie reguły wyodrębniania zostaną dodane do żądania. Drugie żądanie dotyczy, gdzie będą powiązane wyodrębniona wartość.

2.  Zaznacz lub wyczyść pole wyboru obok parametrów dynamicznych, które chcesz automatycznie skorelować. Domyślnie sprawdzane są wszystkie parametry dynamiczne.

### <a name="q-do-i-need-to-configure-visual-studio-to-detect-dynamic-parameters"></a>P: czy należy skonfigurować program Visual Studio do wykrywania parametrów dynamicznych?

 **Odp.:** domyślnej konfiguracji programu Visual Studio jest do wykrywania parametrów dynamicznych podczas rejestrowania testu wydajności sieci web. Jednak jeśli masz skonfigurowane opcje programu Visual Studio, aby nie wykrywać dynamicznych parametrów lub testowana aplikacja sieci web modyfikowana dodatkowymi parametrami dynamicznych; nadal można uruchomić wykrywanie parametrów dynamicznych z edytora testu wydajności sieci Web.